import{r as j,P as i,j as e,u as D}from"./index-D2inHSVb.js";import{c as b,B as T,H as F}from"./Button-CZjkuQWG.js";import{u as M,H as B,I as G,T as K}from"./useForm-CQu2Tm2H.js";import{u as A}from"./useTranslation-0psHgoRi.js";import{v as V}from"./v4-CmTdKEVZ.js";const U=3;function W(r,o){const[a,_]=j.useState(1),d=j.useMemo(()=>r?[...r].sort((p,u)=>new Date(u.createdAt)-new Date(p.createdAt)):[],[r]),v=j.useMemo(()=>d.slice(0,a*U),[d,a]),m=v.length<d.length,c=()=>{_(p=>p+1)},n=()=>{_(1)};return j.useEffect(()=>{n()},[o]),{visibleReviews:v,hasMore:m,handleLoadMore:c,sortedReviews:d,resetPagination:n}}const Y="_avatar_1610f_1",J={avatar:Y},k=({name:r})=>{const o=(r==null?void 0:r.charAt(0).toUpperCase())||"?";return e.jsx("div",{className:J.avatar,title:r,children:o})};k.propTypes={name:i.string.isRequired};const h={"no-review":"_no-review_nu1fx_1","review-container":"_review-container_nu1fx_8","review-header":"_review-header_nu1fx_19","review-name-rating":"_review-name-rating_nu1fx_30","reviewer-name":"_reviewer-name_nu1fx_39","review-rating":"_review-rating_nu1fx_49","filled-star":"_filled-star_nu1fx_54","empty-star":"_empty-star_nu1fx_59","review-date":"_review-date_nu1fx_64","review-comment":"_review-comment_nu1fx_76"};function I({review:r}){if(!r)return e.jsx("p",{className:h["no-review"],children:"Review data is not available."});const o=r.reviewer_name||r["reviewer-name"],a=r.review_text||r.comment,_=r.reviewer_rating??0,d=r.createdAt?new Date(r.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"Unknown date",v=m=>Array.from({length:5},(c,n)=>e.jsx("span",{className:n<m?h["filled-star"]:h["empty-star"],children:"★"},n));return e.jsxs("div",{className:h["review-container"],children:[e.jsxs("div",{className:h["review-header"],children:[e.jsx(k,{name:o}),e.jsxs("div",{className:h["review-name-rating"],children:[e.jsx("div",{className:h["reviewer-name"],children:o||"Anonymous"}),e.jsx("div",{className:h["review-rating"],children:v(_)})]}),e.jsx("div",{className:h["review-date"],children:d})]}),(a==null?void 0:a.trim())&&e.jsx("div",{className:h["review-comment"],children:a})]})}I.propTypes={review:i.shape({reviewer_name:i.string,"reviewer name":i.string,review_text:i.string,comment:i.string,reviewer_rating:i.number,createdAt:i.string})};const S={"reviews-list":"_reviews-list_14vee_1","review-item":"_review-item_14vee_23","with-border":"_with-border_14vee_31"},q=j.forwardRef(({reviews:r},o)=>e.jsx("ul",{className:S["reviews-list"],children:r.map((a,_)=>{const d=_===r.length-1;return e.jsx("li",{className:`${S["review-item"]} ${d?"":S["with-border"]}`,ref:d?o:null,children:e.jsx(I,{review:a})},a.id||a._id)})}));q.displayName="ReviewsList";q.propTypes={reviews:i.arrayOf(i.shape({id:i.string,_id:i.string,createdAt:i.string.isRequired,reviewer_name:i.string,comment:i.string,rating:i.number})).isRequired};const O="_label_mz1x6_25",Q="_stars_mz1x6_85",X="_star_mz1x6_85",Z="_filled_mz1x6_121",ee="_empty_mz1x6_129",f={"field-form":"_field-form_mz1x6_1",label:O,"input-and-error-wrapper":"_input-and-error-wrapper_mz1x6_39","input-error":"_input-error_mz1x6_69",stars:Q,star:X,filled:Z,empty:ee,"error-popup":"_error-popup_mz1x6_147"},P=({value:r,onChange:o,name:a="rating",totalStars:_=5,size:d=24,colorActive:v="#ffc107",colorInactive:m="#948f8fff",error:c,accessible:n=!0,readOnly:p=!1})=>{const u=x=>{!o||p||(x.key==="ArrowRight"&&r<_?o(r+1):x.key==="ArrowLeft"&&r>1&&o(r-1))};return e.jsxs("div",{className:f["field-form"],children:[e.jsx("label",{htmlFor:a,className:f.label,children:"Rating*"}),e.jsxs("div",{id:a,className:b(f["input-and-error-wrapper"],{[f["input-error"]]:c}),role:n?"radiogroup":void 0,"aria-label":n?"Rating":void 0,tabIndex:n?0:void 0,onKeyDown:n?u:void 0,style:{"--active-star-color":v,"--inactive-star-color":m},children:[e.jsx("div",{className:f.stars,children:[...Array(_)].map((x,g)=>{const w=g+1;return e.jsx("span",{className:b(f.star,{[f.filled]:w<=r,[f.empty]:w>r}),style:{fontSize:`${d}px`,cursor:p?"default":"pointer"},role:n?"radio":void 0,"aria-checked":n?w===r:void 0,tabIndex:n?0:void 0,onClick:()=>{p||o(r===w?0:w)},onKeyDown:s=>{n&&(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),!p&&o(w))},children:"★"},w)})}),!p&&e.jsx("input",{type:"hidden",name:a,value:r}),c&&e.jsx("p",{className:f["error-popup"],children:c})]})]})};P.propTypes={value:i.number.isRequired,onChange:i.func,name:i.string,totalStars:i.number,size:i.number,colorActive:i.string,colorInactive:i.string,error:i.string,accessible:i.bool,readOnly:i.bool};const re="_form_1ewqv_1",te="_textform_1ewqv_31",ne="_inputs_1ewqv_36",se="_label_1ewqv_88",t={form:re,"title-form":"_title-form_1ewqv_17","text-title-form":"_text-title-form_1ewqv_26",textform:te,"inputs-area":"_inputs-area_1ewqv_36",inputs:ne,"input-and-error-wrapper":"_input-and-error-wrapper_1ewqv_49","field-form":"_field-form_1ewqv_59","field-area":"_field-area_1ewqv_70","comment-and-counterr-wapper":"_comment-and-counterr-wapper_1ewqv_81",label:se,"label-comment":"_label-comment_1ewqv_95","modal-input":"_modal-input_1ewqv_103","modal-text-area":"_modal-text-area_1ewqv_104","element-submit":"_element-submit_1ewqv_151","char-count":"_char-count_1ewqv_157","char-count-warning":"_char-count-warning_1ewqv_167","error-popup":"_error-popup_1ewqv_172","general-error-popup":"_general-error-popup_1ewqv_173","input-error":"_input-error_1ewqv_196"},z=({camperId:r,onReviewAdded:o})=>{const{t:a}=A(),_=D(),d={name:"",email:"",rating:0,comment:""},v={name:s=>s.trim()?s.length<2||s.length>20?"The name must be between 2 and 20 characters long.":null:"Please fill in this field.",email:s=>s.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?s.length>40?"Email is too long.":null:"Invalid email format.":"Please fill in this field.",rating:s=>s?null:"Please rate.",comment:s=>s.trim()?s.length>150?"The comment must contain up to 150 characters.":null:"Please fill in this field."},m=async s=>{console.log("1. onSubmit - Sending function launched");const R={reviewer_name:s.name.trim(),reviewer_rating:parseInt(s.rating,10),comment:s.comment.trim(),email:s.email.trim(),id:V(),camperId:r,createdAt:new Date().toISOString()};try{console.log("2. onSubmit - Simulate API request delay..."),await new Promise(y=>setTimeout(y,300)),console.log("3. onSubmit - Request simulation complete"),console.log("4. onSubmit - Calling onReviewAdded..."),await o(R),console.log("5. onSubmit - onReviewAdded completed. Data sent:",R),console.log("6. onSubmit - Navigation to the thank you page..."),_("/thank-you")}catch(y){console.error("Error sending form:",y)}},{formData:c,errors:n,isSubmitting:p,hasAttemptedSubmit:u,submissionError:x,handleInputChange:g,handleSubmit:w}=M(d,v,m);return console.log("Render FormReview - isSubmitting:",p,"hasAttemptedSubmit:",u),e.jsxs("form",{className:t.form,onSubmit:w,noValidate:!0,children:[e.jsxs("div",{className:t["title-form"],children:[e.jsx("h3",{className:t["text-title-form"],children:"Submit your review now"}),e.jsx("p",{className:t["text-form"],children:"Stay connected! We are always ready to help you."})]}),e.jsx("div",{className:t["inputs-area"],children:e.jsxs("div",{className:t.inputs,children:[e.jsxs("div",{className:t["field-form"],children:[e.jsx("label",{htmlFor:"user-name-input",className:t.label,children:"Name*"}),e.jsxs("div",{className:t["input-and-error-wrapper"],children:[e.jsx("input",{id:"user-name-input",name:"name",type:"text",className:b(t["modal-input"],{[t["input-error"]]:u&&n.name}),value:c.name,onChange:g,required:!0}),u&&n.name&&e.jsx("p",{className:t["error-popup"],children:n.name})]})]}),e.jsxs("div",{className:t["field-form"],children:[e.jsx("label",{htmlFor:"user-email-input",className:t.label,children:"Email*"}),e.jsxs("div",{className:t["input-and-error-wrapper"],children:[e.jsx("input",{id:"user-email-input",name:"email",type:"email",className:b(t["modal-input"],{[t["input-error"]]:u&&n.email}),value:c.email,onChange:g,required:!0}),u&&n.email&&e.jsx("p",{className:t["error-popup"],children:n.email})]})]}),e.jsx(P,{value:c.rating,onChange:s=>g({target:{name:"rating",value:s}}),name:"rating",error:u?n.rating:null,accessible:!0,className:t["rating-field"]}),e.jsxs("div",{className:t["field-area"],children:[e.jsxs("div",{className:t["comment-and-counter-wrapper"],children:[e.jsx("label",{htmlFor:"user-comment",className:t["label-comment"],children:"Comment*"}),e.jsxs("p",{className:b(t["char-count"],{[t["char-count-warning"]]:c.comment.length>=150}),children:[c.comment.length," / 150"]})]}),e.jsxs("div",{className:b(t["input-and-error-wrapper"],t["comment-input-wrapper"]),children:[e.jsx("textarea",{id:"user-comment",name:"comment",placeholder:"Your message",className:b(t["modal-text-area"],{[t["input-error"]]:u&&n.comment}),value:c.comment,onChange:g,required:!0}),u&&n.comment&&e.jsx("p",{className:t["error-popup"],children:n.comment})]})]})]})}),e.jsxs("div",{className:t["element-submit"],children:[e.jsx(T,{variant:"primary",size:"medium",type:"submit",disabled:p||Object.values(n).some(s=>s!==null),children:p?a("submiting_button",{ns:"button"}):a("submit_button",{ns:"button"})}),x&&e.jsx("p",{className:b(t["error-popup"],t["general-error-popup"]),children:x})]})]})};z.propTypes={camperId:i.string.isRequired,onReviewAdded:i.func.isRequired};const ie="_container_p875p_1",ae="_text_p875p_24",oe="_visible_p875p_176",le="_triangle_p875p_181",l={container:ie,"container-content-reviews":"_container-content-reviews_p875p_12","container-text":"_container-text_p875p_18",text:ae,"list-reviews-form-review":"_list-reviews-form-review_p875p_37","list-reviews":"_list-reviews_p875p_37","container-form-review":"_container-form-review_p875p_49","blok-list-button":"_blok-list-button_p875p_68","reviews-content-wrapper":"_reviews-content-wrapper_p875p_75","container-buttons":"_container-buttons_p875p_103","buttons-wrapper":"_buttons-wrapper_p875p_112","load-more-wrapper":"_load-more-wrapper_p875p_119","load-more-btn":"_load-more-btn_p875p_128","no-reviews":"_no-reviews_p875p_133","scroll-to-top-btn":"_scroll-to-top-btn_p875p_140",visible:oe,triangle:le};function _e({camper:r,activeTab:o,reviews:a,onReviewAdded:_}){const{t:d}=A(),v=r._id||r.id,m=j.useRef(null),c=j.useRef(null),{visibleReviews:n,hasMore:p,handleLoadMore:u,sortedReviews:x,resetPagination:g}=W(a,v),[w,s]=j.useState(!1),R=()=>{setTimeout(()=>{m.current&&c.current&&c.current.offsetTop>m.current.offsetHeight&&m.current.scrollTo({top:m.current.scrollHeight,behavior:"smooth"})},100)},y=[l["blok-reviews-form"]];x.length>3&&y.push(l["blok-reviews-form-scrollable"]);const C=N=>{_(N),R()},E=()=>{const N=m.current;if(N){const H=N.scrollHeight;u(),setTimeout(()=>{const L=N.scrollHeight;N.scrollTo({top:N.scrollTop+(L-H),behavior:"smooth"}),s(!0)},100)}},$=()=>{m.current&&(m.current.scrollTo({top:0,behavior:"smooth"}),s(!1),g())};return e.jsxs("div",{className:l.container,children:[e.jsx(F,{}),e.jsxs("div",{className:l["container-content-reviews"],children:[e.jsx(B,{camper:r}),e.jsx(G,{gallery:r.gallery}),e.jsx("div",{className:l["container-text"],children:e.jsx("p",{className:l.text,children:r.description})}),e.jsx(K,{camper:r,activeTab:o}),e.jsxs("div",{className:l["list-reviews-form-review"],children:[e.jsx("div",{className:l["list-reviews"],children:e.jsx("div",{className:y.join(" "),children:a&&a.length>0?e.jsxs("div",{className:l["blokL-list-button"],children:[e.jsx("div",{className:l["reviews-content-wrapper"],ref:m,children:e.jsx(q,{reviews:n,ref:c})}),p&&e.jsx("div",{className:l["buttons-wrapper"],children:e.jsx(T,{variant:"primary",size:"medium",onClick:E,className:l["load-more-btn"],children:d("load_button",{ns:"button"})})}),w&&e.jsx("div",{className:l["buttons-wrapper"],children:e.jsx("div",{onClick:$,className:`${l["scroll-to-top-btn"]} ${l.visible}`,children:e.jsx("div",{className:l.triangle})})})]}):e.jsx("p",{className:l["no-reviews"],children:"No reviews yet"})})}),e.jsx("div",{className:l["container-form-review"],children:e.jsx(z,{camperId:v,onReviewAdded:C})})]})]})]})}export{_e as default};
